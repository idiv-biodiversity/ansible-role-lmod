---

- name: 'install lmod dependencies {{ __lmod_dependencies }}'
  ansible.builtin.apt:
    name: '{{ __lmod_dependencies | join(",") }}'
  become: yes

# https://github.com/TACC/Lmod/commit/1d15717144f595b9a09e8421aa00b5dead3ed21d
- name: fix lua-posix on Ubuntu
  ansible.builtin.file:
    src: /usr/lib/x86_64-linux-gnu/liblua5.3-posix.so
    dest: /usr/lib/x86_64-linux-gnu/lua/5.3/posix.so
    state: link
  become: yes
  when: >-
    __lmod_os_version == 'ubuntu_18'
    or
    __lmod_os_version == 'ubuntu_20'

...
